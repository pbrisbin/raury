require 'spec_helper'

describe Raury::Vercmp do
  [ # pacman/test/utils/vercmptest.sh
    ['1.5.0'   ,'1.5.0'   , 0],
    ['1.5.1'   ,'1.5.0'   , 1],
    ['1.5.1'   ,'1.5'     , 1],
    ['1.5.0-1' ,'1.5.0-1' , 0],
    ['1.5.0-1' ,'1.5.0-2' ,-1],
    ['1.5.0-1' ,'1.5.1-1' ,-1],
    ['1.5.0-2' ,'1.5.1-1' ,-1],
    ['1.5-1'   ,'1.5.1-1' ,-1],
    ['1.5-2'   ,'1.5.1-1' ,-1],
    ['1.5-2'   ,'1.5.1-2' ,-1],
    ['1.5'     ,'1.5-1'   , 0],
    ['1.5-1'   ,'1.5'     , 0],
    ['1.1-1'   ,'1.1'     , 0],
    ['1.0-1'   ,'1.1'     ,-1],
    ['1.1-1'   ,'1.0'     , 1],
    ['1.5b-1'  ,'1.5-1'   ,-1],
    ['1.5b'    ,'1.5'     ,-1],
    ['1.5b-1'  ,'1.5'     ,-1],
    ['1.5b'    ,'1.5.1'   ,-1],
    ['1.0a'    ,'1.0alpha',-1],
    ['1.0alpha','1.0b'    ,-1],
    ['1.0b'    , '1.0beta',-1],
    ['1.0beta' ,'1.0rc'   ,-1],
    ['1.0rc'   ,'1.0'     ,-1],
    ['1.5.a'   ,'1.5'     ,1],
    ['1.5.b'   ,'1.5.a'   ,1],
    ['1.5.1'   ,'1.5.b'   ,1],
    ['1.5.b-1' ,'1.5.b'   ,0],
    ['1.5-1'   ,'1.5.b'   ,-1],
    ['2.0'     ,'2_0'     ,0],
    ['2.0_a'   ,'2_0.a'   ,0],
    ['2.0a'    ,'2.0.a'   ,-1],
    ['2___a'   ,'2_a'     , 1],
    ['0:1.0'   ,'0:1.0'   , 0],
    ['0:1.0'   ,'0:1.1'   ,-1],
    ['1:1.0'   ,'0:1.0'   , 1],
    ['1:1.0'   ,'0:1.1'   , 1],
    ['1:1.0'   ,'2:1.1'   ,-1],
    ['1:1.0'   ,'0:1.0-1' , 1],
    ['1:1.0-1' ,'0:1.1-1' , 1],
    ['0:1.0'   ,'1.0'     , 0],
    ['0:1.0'   ,'1.1'     ,-1],
    ['0:1.1'   ,'1.0'     , 1],
    ['1:1.0'   ,'1.0'     , 1],
    ['1:1.0'   ,'1.1'     , 1],
    ['1:1.1'   ,'1.1'     , 1],

  ].each do |v1, v2, expd|
    it "compares #{v1} and #{v2} correctly" do
      a = Raury::Vercmp.new(v1)
      b = Raury::Vercmp.new(v2)

      (a <=> b).should == expd
    end
  end
end
